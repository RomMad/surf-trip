{% set current_route_parameters = app.current_route_parameters|default({}) %}

<header>
     <nav class="app-header-nav" aria-label="{{ 'navigation.main.label'|trans }}">
        <div class="app-header-container">
            <button
                class="app-header-toggle"
                type="button"
                data-twe-collapse-init
                data-twe-target="#main_navbar"
                aria-controls="main_navbar"
                aria-expanded="false"
                aria-label="{{ 'navigation.toggle.label'|trans }}"
            >
                <twig:ux:icon name="lucide:menu" height="1.5em" width="1.5em" />
            </button>

            <a class="app-header-brand" href="/">
                {{- 'app_name'|trans -}}
            </a>

            <div class="app-header-menu" id="main_navbar">
                <ul class="flex">
                    <twig:Header:NavLink label="trips.label" route="app.trip.index" />
                    <twig:Header:NavLink label="trip.new.label" route="app.trip.new" />
                </ul>
                <ul class="flex items-center" aria-label="{{ 'language.switch.label'|trans }}">
                    {% for locale in supported_locales %}
                        <li>
                            <twig:Button as="a"
                                variant="link"
                                class="p-1"
                                href="{{ path(app.current_route, current_route_parameters|merge({_locale: locale})) }}"
                                title="{{ ('language.' ~ locale ~ '.label')|trans }}"
                                :disabled="app.request.locale is same as(locale)"
                            >
                                <twig:ux:icon name="circle-flags:lang-{{ locale }}" />
                            </twig:Button>
                        </li>
                        {% if not loop.last %}
                            <li>|</li>
                        {% endif %}
                    {% endfor %}
                </ul>
                <twig:Header:DarkModeSwitch />
            </div>

            <div class="flex items-center">
                {% if app.user %}
                    <twig:Button as="a" href="{{ path('app.logout') }}" class="text-primary-foreground" data-turbo="false">
                        {{- 'logout.label'|trans -}}
                    </twig:Button>
                    <div class="hidden items-center gap-2 rounded-md border border-primary-foreground/30 px-2 py-1 text-sm text-primary-foreground sm:flex">
                        <twig:ux:icon name="lucide:user"  height="1.2em" width="1.2em" />
                        <span class="max-w-40 truncate">
                            {{- app.user.firstName -}}
                        </span>
                    </div>
                {% else %}
                    <div>
                        <twig:Button as="a" href="{{ path('app.login') }}" class="text-primary-foreground">
                            {{ 'login.label'|trans }}
                            </twig:Button>
                        <twig:Button as="a" href="{{ path('app.register') }}" class="text-primary-foreground">
                            {{ 'register.label'|trans }}
                        </twig:Button>
                    </div>
                {% endif %}
            </div>
        </div>
    </nav>
</header>
